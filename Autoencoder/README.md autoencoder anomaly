# ðŸ§  SUSNATA's Autoencoder-Based Credit Card Anomaly Detection  
A reconstruction-errorâ€“based unsupervised model for identifying abnormal credit card transactions using PCA-transformed features.

---

## ðŸ“Œ Overview  
This project implements an **unsupervised deep learning anomaly detection system** using an autoencoder trained only on normal transactions.  
Fraudulent or unusual transactions are detected by measuring **reconstruction error**, where high error indicates deviation from learned normal patterns.

---

## ðŸ“‚ Dataset  
- PCA-transformed credit card dataset  
- Normalized (mean = 0, variance = 1)  
- Columns dropped: `Time`, `Amount`, `Class` (labels used only for evaluation)

---

## âš™ï¸ Preprocessing  
```python
X = df.drop(["Class","Time","Amount"], axis=1).values
y = df["Class"].values
```

- Training/test split with stratification  
- Only **Class = 0** samples used to train the autoencoder  

```python
X_train_normal = X_train[y_train == 0]
```

---

## ðŸ—ï¸ Model Architecture  
A simple symmetric autoencoder:

```python
encoder:
  Input (28)
  Dense(14, relu)
  Dense(7, relu)

decoder:
  Dense(14, relu)
  Dense(28, sigmoid)
```

Complete build:

```python
autoencoder = Model(inputs, decoder(encoder(inputs)))
autoencoder.compile(optimizer="adam", loss="mse")
```

---

## ðŸ‹ï¸ Training  
```python
history = autoencoder.fit(
    X_train_normal,
    X_train_normal,
    epochs=20,
    batch_size=256,
    validation_split=0.2,
    shuffle=True
)
```

---

## ðŸ“‰ Reconstruction Error  
Training MSE:

```python
train_mse = np.mean((X_train_normal - recon_train)**2, axis=1)
```

Testing MSE:

```python
test_mse = np.mean((X_test - recon_test)**2, axis=1)
```

---

## ðŸŽšï¸ Threshold Selection  
We use the **95th percentile** of normal training errors:

```python
threshold = np.percentile(train_mse, 95)
```

Transactions with MSE > threshold â†’ **Anomaly**

---

## ðŸš¨ Anomaly Detection  
```python
anomalies = test_mse > threshold
```

---

## ðŸ“Š Evaluation  
Confusion matrix and classification report:

```python
cm = confusion_matrix(y_test, anomalies)
print(cm)
print(classification_report(y_test, anomalies))
```

**Performance highlight:**  
- High recall for fraud transactions  
- Suitable for rare-event detection scenarios  

---

## ðŸ’¾ Saving the Model  
```python
autoencoder.save("/content/drive/MyDrive/final_autoencoder_model.h5")
```

---

## ðŸ“¤ Exporting Detected Anomalies  
```python
anomalies_df.to_csv("/content/drive/MyDrive/detected_anomalies.csv", index=False)
```

---

## ðŸ§ª Inference Example  
```python
new_data = np.random.randn(5, 28)
recon = autoencoder.predict(new_data)
mse = np.mean((new_data - recon)**2, axis=1)
anomalies = mse > threshold
print(anomalies)
```

---

## âœ… Summary  
- Unsupervised autoencoder  
- Learns normal behavior only  
- Detects anomalies via reconstruction error  
- Effective for fraud detection, intrusion detection, and other rare anomaly tasks